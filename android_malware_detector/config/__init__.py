import os
import json


def load_config(config_path=""):
    config = None
    if not config_path:
        CONFIG_DIR = os.path.abspath(os.path.dirname(__file__))
        config_path = os.path.join(CONFIG_DIR, 'config.json')
    try:
        config = json.load(open(config_path))
    except Exception, e:
        print "Error when read configuration file. {}".format(e.message)
    return config


def new_config(cf):
    CONFIG_DIR = os.path.abspath(os.path.dirname(__file__))
    config_path = os.path.join(CONFIG_DIR, 'config.json')
    try:
        config = json.load(open(config_path))
        config.update(cf)
        json.dump(config, open(config_path, 'w'), indent=4, sort_keys=True)
    except Exception, e:
        print "Error when save configuration. {}".format(e.message)


def del_config(key):
    CONFIG_DIR = os.path.abspath(os.path.dirname(__file__))
    config_path = os.path.join(CONFIG_DIR, 'config.json')
    try:
        config = json.load(open(config_path))
        del config[key]
        config[key] = None
        json.dump(config, open(config_path, 'w'), indent=4, sort_keys=True)
    except Exception, e:
        print "Error when delete configuration. {}".format(e.message)
