import os
from model import MLModel
from sklearn.externals import joblib


class GBMModel(MLModel):

    name = "Gradient Boosted Tree Model"

    def __init__(self):
        MLModel.__init__(self)

    def predict(self, feature_vector):
        try:
            gbm_path = os.path.dirname(os.path.abspath(__file__))
            model_path = os.path.join(gbm_path, 'model.pkl')
            gbm = joblib.load(model_path)
            return gbm.predict(feature_vector)[0]
        except Exception, e:
            print '[ERROR] Cannot predict with this feature vector: {}'.format(e)
