import numpy as np
from preprocess import APKExtractor
from preprocess.transform import VectorTransformFactory
from model import ModelFactory


def APKAnalyze(fp, model_name, tmp_dir='./', verbose=True):
    raw_data = APKExtractor.extract(fp, tmp_dir)
    feature_vector = VectorTransformFactory.get_transform_result(raw_data, model_name)
    malware_rate = ModelFactory.get_predict_result(feature_vector, model_name)
    if verbose:
        if np.round(malware_rate) == 1:
            print "[INFO][ANALYZE RESULT] This file has %0.2f%% to be a malware" % (res * 100)
        else:
            print "[INFO][ANALYZE RESULT] This file is not a malware (result: %0.2f%%)" % (res * 100)
    return malware_rate
